<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Command Errors</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="../_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="../_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="../_static/css/font-awesome.css" rel="stylesheet">

<!-- Custom CSS -->
<link href="../_static/css/combined.css" rel="stylesheet">

  


  </head>
  <body>
 <script type="text/javascript">
    (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
                (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
        e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
    })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

    _st('install','aDn5L_vgZ2yzRcE893kK','2.0.0');
</script>
<nav class="navbar navbar-default" role="navigation">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="https://www.openstack.org/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
         <form class="docs-main-search-form">
    <input type="text" class="st-default-search-input custom-search-box" placeholder="Search OpenStack">
</form>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
           <li>
    <input type="text" class="st-default-search-input custom-search-box-mobile" placeholder="Search OpenStack">
</li>
        </li>
        <li>
          <a href="https://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="https://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="https://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="https://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="https://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="https://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="https://docs.openstack.org/">Docs</a>
        </li>
        <li>

</li>


            <li>

                <li class="join-nav-section">
                    <a href="https://www.openstack.org/join/" id="dropdownMenuJoin">Join <i class="fa fa-caret-down"></i></a>
                    <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuJoin" style="display: none;">
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/join/register/?membership-type=foundation">Sign up for Foundation Membership</a></li>
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/join/#sponsor">Sponsor the Foundation</a></li>
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/foundation">More about the Foundation</a></li>
                    </ul>
                </li>
                <li>
                    <a href="https://www.openstack.org/Security/login/?BackURL=/home/" class="sign-in-btn">Log In</a>
                </li>

            </li>
      </ul>
    </div>
  </div>
  <!-- /.container -->
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>Command Errors</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="command-wrappers.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Command Class Wrappers"></i></a>
    
    
    <a href="command-logs.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Command Logs"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2018-10-17 03:32</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="../index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Command Errors</a><ul>
<li><a class="reference internal" href="#general-command-errors">General Command Errors</a><ul>
<li><a class="reference internal" href="#external-errors">External Errors</a><ul>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#rest-api-errors">REST API Errors</a><ul>
<li><a class="reference internal" href="#multiple-rest-api-calls">Multiple REST API Calls</a><ul>
<li><a class="reference internal" href="#example-1">Example 1</a></li>
<li><a class="reference internal" href="#example-2">Example 2</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="command-errors">
<h1>Command Errors<a class="headerlink" href="#command-errors" title="Permalink to this headline">¶</a></h1>
<p>Handling errors in OpenStackClient commands is fairly straightforward.  An
exception is thrown and handled by the application-level caller.</p>
<p>Note: There are many cases that need to be filled out here.  The initial
version of this document considers the general command error handling as well
as the specific case of commands that make multiple REST API calls and how to
handle when one or more of those calls fails.</p>
<div class="section" id="general-command-errors">
<h2>General Command Errors<a class="headerlink" href="#general-command-errors" title="Permalink to this headline">¶</a></h2>
<p>The general pattern for handling OpenStackClient command-level errors is to
raise a CommandError exception with an appropriate message.  This should include
conditions arising from arguments that are not valid/allowed (that are not otherwise
enforced by <code class="docutils literal"><span class="pre">argparse</span></code>) as well as errors arising from external conditions.</p>
<div class="section" id="external-errors">
<h3>External Errors<a class="headerlink" href="#external-errors" title="Permalink to this headline">¶</a></h3>
<p>External errors are a result of things outside OpenStackClient not being as
expected.</p>
<div class="section" id="example">
<h4>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h4>
<p>This example is taken from <code class="docutils literal"><span class="pre">keypair</span> <span class="pre">create</span></code> where the <code class="docutils literal"><span class="pre">--public-key</span></code> option
specifies a file containing the public key to upload.  If the file is not found,
the IOError exception is trapped and a more specific CommandError exception is
raised that includes the name of the file that was attempted to be opened.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CreateKeypair</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">ShowOne</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create new public key&quot;&quot;&quot;</span>

    <span class="c1">## ...</span>

    <span class="k">def</span> <span class="nf">take_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed_args</span><span class="p">):</span>
        <span class="n">compute_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">client_manager</span><span class="o">.</span><span class="n">compute</span>

        <span class="n">public_key</span> <span class="o">=</span> <span class="n">parsed_args</span><span class="o">.</span><span class="n">public_key</span>
        <span class="k">if</span> <span class="n">public_key</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">parsed_args</span><span class="o">.</span><span class="n">public_key</span><span class="p">),</span>
                    <span class="s2">&quot;rb&quot;</span>
                <span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
                    <span class="n">public_key</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Key file </span><span class="si">%s</span><span class="s2"> not found: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">CommandError</span><span class="p">(</span>
                    <span class="n">msg</span> <span class="o">%</span> <span class="p">(</span><span class="n">parsed_args</span><span class="o">.</span><span class="n">public_key</span><span class="p">,</span> <span class="n">e</span><span class="p">),</span>
                <span class="p">)</span>

        <span class="n">keypair</span> <span class="o">=</span> <span class="n">compute_client</span><span class="o">.</span><span class="n">keypairs</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">parsed_args</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">public_key</span><span class="o">=</span><span class="n">public_key</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1">## ...</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="rest-api-errors">
<h2>REST API Errors<a class="headerlink" href="#rest-api-errors" title="Permalink to this headline">¶</a></h2>
<p>Most commands make a single REST API call via the supporting client library
or SDK.  Errors based on HTML return codes are usually handled well by default,
but in some cases more specific or user-friendly messages need to be logged.
Trapping the exception and raising a CommandError exception with a useful
message is the correct approach.</p>
<div class="section" id="multiple-rest-api-calls">
<h3>Multiple REST API Calls<a class="headerlink" href="#multiple-rest-api-calls" title="Permalink to this headline">¶</a></h3>
<p>Some CLI commands make multiple calls to library APIs and thus REST APIs.
Most of the time these are <code class="docutils literal"><span class="pre">create</span></code> or <code class="docutils literal"><span class="pre">set</span></code> commands that expect to add or
change a resource on the server.  When one of these calls fails, the behaviour
of the remainder of the command handler is defined as such:</p>
<ul class="simple">
<li>Whenever possible, all API calls will be made.  This may not be possible for
specific commands where the subsequent calls are dependent on the results of
an earlier call.</li>
<li>Any failure of an API call will be logged for the user</li>
<li>A failure of any API call results in a non-zero exit code</li>
<li>In the cases of failures in a <code class="docutils literal"><span class="pre">create</span></code> command a follow-up mode needs to
be present that allows the user to attempt to complete the call, or cleanly
remove the partially-created resource and re-try.</li>
</ul>
<p>The desired behaviour is for commands to appear to the user as idempotent
whenever possible, i.e. a partial failure in a <code class="docutils literal"><span class="pre">set</span></code> command can be safely
retried without harm.  <code class="docutils literal"><span class="pre">create</span></code> commands are a harder problem and may need
to be handled by having the proper options in a set command available to allow
recovery in the case where the primary resource has been created but the
subsequent calls did not complete.</p>
<div class="section" id="example-1">
<h4>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h4>
<p>This example is taken from the <code class="docutils literal"><span class="pre">volume</span> <span class="pre">snapshot</span> <span class="pre">set</span></code> command where <code class="docutils literal"><span class="pre">--property</span></code>
arguments are set using the volume manager’s <code class="docutils literal"><span class="pre">set_metadata()</span></code> method,
<code class="docutils literal"><span class="pre">--state</span></code> arguments are set using the <code class="docutils literal"><span class="pre">reset_state()</span></code> method, and the
remaining arguments are set using the <code class="docutils literal"><span class="pre">update()</span></code> method.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SetSnapshot</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">Command</span><span class="p">):</span>
<span class="sd">&quot;&quot;&quot;Set snapshot properties&quot;&quot;&quot;</span>

<span class="c1">## ...</span>

<span class="k">def</span> <span class="nf">take_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed_args</span><span class="p">):</span>
    <span class="n">volume_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">client_manager</span><span class="o">.</span><span class="n">volume</span>
    <span class="n">snapshot</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">find_resource</span><span class="p">(</span>
        <span class="n">volume_client</span><span class="o">.</span><span class="n">volume_snapshots</span><span class="p">,</span>
        <span class="n">parsed_args</span><span class="o">.</span><span class="n">snapshot</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">parsed_args</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parsed_args</span><span class="o">.</span><span class="n">name</span>
    <span class="k">if</span> <span class="n">parsed_args</span><span class="o">.</span><span class="n">description</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parsed_args</span><span class="o">.</span><span class="n">description</span>

    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">parsed_args</span><span class="o">.</span><span class="n">property</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">volume_client</span><span class="o">.</span><span class="n">volume_snapshots</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span>
                <span class="n">snapshot</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="n">parsed_args</span><span class="o">.</span><span class="n">property</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">SomeException</span><span class="p">:</span>      <span class="c1"># Need to define the exceptions to catch here</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Property set failed&quot;</span><span class="p">))</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">parsed_args</span><span class="o">.</span><span class="n">state</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">volume_client</span><span class="o">.</span><span class="n">volume_snapshots</span><span class="o">.</span><span class="n">reset_state</span><span class="p">(</span>
                <span class="n">snapshot</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="n">parsed_args</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">SomeException</span><span class="p">:</span>      <span class="c1"># Need to define the exceptions to catch here</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;State set failed&quot;</span><span class="p">))</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">volume_client</span><span class="o">.</span><span class="n">volume_snapshots</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="n">snapshot</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="n">SomeException</span><span class="p">:</span>      <span class="c1"># Need to define the exceptions to catch here</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Update failed&quot;</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># NOTE(dtroyer): We need to signal the error, and a non-zero return code,</span>
    <span class="c1">#                without aborting prematurely</span>
    <span class="k">if</span> <span class="n">result</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">SomeNonFatalException</span>
</pre></div>
</div>
</div>
<div class="section" id="example-2">
<h4>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h4>
<p>This example is taken from the <code class="docutils literal"><span class="pre">network</span> <span class="pre">delete</span></code> command which takes multiple
networks to delete. All networks will be deleted in a loop, which makes
multiple <code class="docutils literal"><span class="pre">delete_network()</span></code> calls.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DeleteNetwork</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">NetworkAndComputeCommand</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Delete network(s)&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">update_parser_common</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s1">&#39;network&#39;</span><span class="p">,</span>
            <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&lt;network&gt;&quot;</span><span class="p">,</span>
            <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Network(s) to delete (name or ID)&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">parser</span>

    <span class="k">def</span> <span class="nf">take_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">,</span> <span class="n">parsed_args</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">network</span> <span class="ow">in</span> <span class="n">parsed_args</span><span class="o">.</span><span class="n">network</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">find_network</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">ignore_missing</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
                <span class="n">client</span><span class="o">.</span><span class="n">delete_network</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">LOG</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Failed to delete network with name &quot;</span>
                            <span class="s2">&quot;or ID </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">),</span> <span class="n">network</span><span class="p">)</span>
                <span class="n">ret</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">ret</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed_args</span><span class="o">.</span><span class="n">network</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Failed to delete </span><span class="si">%(ret)s</span><span class="s2"> of </span><span class="si">%(total)s</span><span class="s2"> networks.&quot;</span><span class="p">)</span>
                   <span class="o">%</span> <span class="p">{</span><span class="s2">&quot;ret&quot;</span><span class="p">:</span> <span class="n">ret</span><span class="p">,</span> <span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="n">total</span><span class="p">})</span>
            <span class="k">raise</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">CommandError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="command-wrappers.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Command Class Wrappers"></i></a>
          
          
            <a href="command-logs.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Command Logs"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2018-10-17 03:32</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="../_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="../index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">User Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference external" href="http://docs.openstack.org/releasenotes/python-openstackclient">Release Notes</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Contributor Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="developing.html">Developing with OpenStackClient</a></li>
<li class="toctree-l2"><a class="reference internal" href="command-beta.html">Command Beta</a></li>
<li class="toctree-l2"><a class="reference internal" href="command-options.html">Command Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="command-wrappers.html">Command Class Wrappers</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Command Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="command-logs.html">Command Logs</a></li>
<li class="toctree-l2"><a class="reference internal" href="specs/commands.html">Command Specs</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="humaninterfaceguide.html">Human Interface Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/modules.html">Modules</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="../_static/js/jquery-3.1.1.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="../_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="../_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="../_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "contributor/command-errors" + ".rst";
        gitURL = "Source: https://git.openstack.org/cgit/openstack/python-openstackclient/tree/doc/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 57c5eb6d8a33f5997d6311116716b0ca72bd886f";
        var bugProject = "python-openstackclient";
        var bugTitle = "Command Errors in python-openstackclient";
    var fieldTags = "";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 3.12.0 on 2018-10-17 03:32";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

  </body>
</html>